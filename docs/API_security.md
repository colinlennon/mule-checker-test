**Securing APIs **

**In general, the knowledge document ** [**Application
Development Security**](https://bayergroup.sharepoint.com/sites/csrm/SitePages/Application-Security-EN.aspx)** applies to APIs.**

[Application Security (sharepoint.com)](https://bayergroup.sharepoint.com/sites/csrm/SitePages/Application-Security-EN.aspx)

The table below maps the security topics to an API-led
architecture. Where present, the table shows additional benefits of the central
API management platform.


| ***Security topic****** ***              | API assessment                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| :----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Software Development Life Cycle (SDLC)   | All developers are certified in Mulesoft development; Security requiremetns are part of the design: Authentication -> personalized access token until SAPI, Authorisation -> to access approval in anypoint needed, Data Classification -> public (see non-functional requirements below), Source code repos in GitHub with controlled deployments to Prod. Mandatory Code review required.                                                                                               |
| Code Quality                             | Usage of DTEF Mulesoft application template and naming conventions. Qualified developers. Logging at production is set to info level only.                                                                                                                                                                                                                                                                                                                                                |
| System Ownership and Data Classification | System and business owner are derived from the assigned business applications in BEAT. Information classification is done during CAMP entries of assigned business application, Data handover document with Data steward, part of TMS CAMP assessment. Process and System API assigned to Ownership of GDA-Masterdata, Experience API to Tax Product Team in PP-GFI                                                                                                                       |
| Application Architecture                 | Passwords and secrets are stored in encrypted properties files and GitHub secrets. encryption key is visible to authorized persons only. API design based on API led connectivity approach. Decoupling source system from target, flexibility and reuse with layered approach. Check non-functional requirements as latency, security to focus on good architectural decisions.                                                                                                           |
| Access Control                           | Anypoint portal access and developer roles in GitHub based on team specific Azure AD groups, managed by PRIMA / PAPI. Anypoint Platform contracts/ API access with approval by data owner (tbd), authentication using Open ID and OAuth2.                                                                                                                                                                                                                                                 |
| Input and Output Validation              | Input validation against RAML API specification in APIKit Router. Further specific validations possible using https://docs.mulesoft.com/validation-connector/1.4/                                                                                                                                                                                                                                                                                                                         |
| Error Management                         | HTTP error codes indicate an error situation, without exposing internal details. Usage of Application Template with error-handling library supports developer in handling occuring errors with user friendly error messages. Error-handling library has been extended to ensure that descriptive error messages returned by the EY API are included in the error response provided by the Mule API.                                                                                       |
| Session and Communication Management     | OIDC access control provides consumers with access tokens which can be used to access a specific API. Each token has a limited validity period of 1 hour, after which the consumer must obtain a new token. Communication between consumers and the experience API, and between experience, process and system APIs, uses the HTTPS protocol. All traffic is encrypted using TLS. For encryption between the Mule experience, process and system APIs, self-signed certificates are used. |
| Secure Resource Access and Local Storage | Trusted, signed SSL certificates for all API endpoints. personalized authorisation is used and transferred to source system. AUD validation in JWT validation policy with user credentials through a different channel used. Credentials are stored in encrypted properties or as GitHub secrets.                                                                                                                                                                                         |
| Mobile Development                       | no explicit mobile development                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Security Event Logging                   | centralized logging in Anypoint control plane. Logging messages via policies and application logs using JSON Logger possible. Best practice is to log at least external calls and masking of sensitive data.                                                                                                                                                                                                                                                                              |
| File Management                          | not used in these APIs                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Temporary Files                          | not used in these APIs                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Development Environments                 | central API management separates non-prod and prod environments. Mocking service provides syntactically correct test data, without exposing restricted data. Access to environments is managed by Azure AD groups.                                                                                                                                                                                                                                                                        |
| Application Promotion                    | Risk assessment is part of change management. Before deployment to production a review including verification of risk is mandatory.                                                                                                                                                                                                                                                                                                                                                       |
| Production Environment                   | API based architecture makes communication between system components explicit and provides a dedicated layer to shield internal components. API gateway supports HTTPS only central CSRM Web Application Firewall rules (WAF) are used, fine-grained MuleSoft policies protect infrastructure and backend. API based architecture makes communication between system components explicit and provides a dedicated layer to shield internal components.                                         |
| Reassessment Criteria                    | Major architectural changes are also part of the change management of the assigned business application application                                                                                                                                                                                                                                                                                                                                                                                   |
| Database Security                        | By using API based access over direct database access, implementing security requirements get easier: OIDC based access control realizes user management, identity verification and authorization. Locate the database in a secured network, expose data in a controlled way to clients outside the network perimeter.                                                                                                                                                                     |
| Business Continuity                      | API contribute to a disaster and recovery plan: run several implementations of an API in parallel. use API to decouple clients and providers. In general the API is part of the disaster and recovery plan of the business application.                                                                                                                                                                                                                                                   |

[20220928_132815_image.png](assets/20220928_132815_image.png)
